<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BQ2A | PLAY MODE</title>
    <style>
        body { margin: 0; background: radial-gradient(circle, #050a18 0%, #000 100%); overflow: hidden; }
        canvas { width: 100%; height: 100%; display: block; }
        .score-board {
            position: absolute; top: 20px; width: 100%; text-align: center;
            color: #00f2ff; font-family: 'Courier New', monospace; pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="score-board">
        <h1 id="status">BQ2A: ACTIVE</h1>
        <p>المس الخوذة لزيادة السرعة!</p>
    </div>

    <canvas id="application-canvas"></canvas>

    <script src="https://code.playcanvas.com/playcanvas-stable.min.js"></script>

    <script>
        const canvas = document.getElementById('application-canvas');
        const app = new pc.Application(canvas, { touch: new pc.TouchDevice(canvas) });
        app.setCanvasFillMode(pc.FILLMODE_FILL_WINDOW);
        app.setCanvasResolution(pc.RESOLUTION_AUTO);
        app.start();

        const camera = new pc.Entity();
        camera.addComponent('camera', { clearColor: new pc.Color(0, 0, 0) });
        app.root.addChild(camera);
        camera.setPosition(0, 0, 5);

        const light = new pc.Entity();
        light.addComponent('light', { type: 'omni', range: 20 });
        app.root.addChild(light);
        light.setPosition(2, 2, 5);

        let entity = null;
        let velocityX = 0.05;
        let velocityY = 0.05;

        const url = 'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/DamagedHelmet/glTF-Binary/DamagedHelmet.glb';
        
        app.assets.loadFromUrl(url, "container", function (err, asset) {
            entity = asset.resource.instantiateRenderEntity();
            app.root.addChild(entity);

            // عند لمس الشاشة، نعطي دفعة قوية للخوذة
            app.touch.on(pc.EVENT_TOUCHSTART, () => {
                velocityX = (Math.random() - 0.5) * 0.2;
                velocityY = (Math.random() - 0.5) * 0.2;
                document.getElementById('status').innerText = "BOOST ACTIVATED!";
                setTimeout(() => document.getElementById('status').innerText = "BQ2A: ACTIVE", 1000);
            });
        });

        app.on('update', dt => {
            if (entity) {
                // تحريك الخوذة بناءً على السرعة
                const pos = entity.getPosition();
                entity.setPosition(pos.x + velocityX, pos.y + velocityY, 0);
                entity.rotate(1, 2, 0);

                // ارتداد من حواف الشاشة (حدود وهمية)
                if (pos.x > 2 || pos.x < -2) velocityX *= -1;
                if (pos.y > 3 || pos.y < -3) velocityY *= -1;
            }
        });

        window.addEventListener('resize', () => app.resizeCanvas());
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BQ2A MOBILE ENGINE</title>
    <style>
        /* قفل الصفحة للجوال */
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #000; touch-action: none; }
        canvas { display: block; width: 100vw; height: 100vh; }

        /* واجهة الجوال */
        .mobile-hud {
            position: absolute; bottom: 40px; width: 100%;
            display: flex; justify-content: space-around; pointer-events: none;
        }
        .action-btn {
            width: 70px; height: 70px; background: rgba(0, 242, 255, 0.2);
            border: 2px solid #00f2ff; border-radius: 50%; color: #00f2ff;
            font-weight: bold; pointer-events: auto; display: flex;
            align-items: center; justify-content: center; backdrop-filter: blur(5px);
            -webkit-tap-highlight-color: transparent;
        }
        .status-bar {
            position: absolute; top: 20px; left: 20px; color: #00f2ff;
            font-family: 'Courier New', monospace; font-size: 12px; pointer-events: none;
        }
    </style>
</head>
<body>

    <div class="status-bar">SYSTEM: BQ2A ONLINE<br>MODE: MOBILE_TOUCH</div>

    <div class="mobile-hud">
        <div class="action-btn" id="btn-zoom">ZOOM</div>
        <div class="action-btn" id="btn-spin">SPIN</div>
    </div>

    <canvas id="application-canvas"></canvas>

    <script src="https://code.playcanvas.com/playcanvas-stable.min.js"></script>

    <script>
        const canvas = document.getElementById('application-canvas');
        const app = new pc.Application(canvas, { touch: new pc.TouchDevice(canvas) });
        app.setCanvasFillMode(pc.FILLMODE_FILL_WINDOW);
        app.setCanvasResolution(pc.RESOLUTION_AUTO);
        app.start();

        // إضاءة سينمائية
        const light = new pc.Entity();
        light.addComponent('light', { type: 'omni', range: 20, color: new pc.Color(0, 1, 1) });
        app.root.addChild(light);
        light.setPosition(2, 5, 5);

        const camera = new pc.Entity();
        camera.addComponent('camera', { clearColor: new pc.Color(0, 0, 0.05) });
        app.root.addChild(camera);
        camera.setPosition(0, 0, 5);

        let mainObject = null;
        const url = 'https://raw.githubusercontent.com/KhronosGroup/glTF-Sample-Models/master/2.0/DamagedHelmet/glTF-Binary/DamagedHelmet.glb';

        app.assets.loadFromUrl(url, "container", function (err, asset) {
            mainObject = asset.resource.instantiateRenderEntity();
            app.root.addChild(mainObject);

            // تحكم اللمس الحقيقي
            app.touch.on(pc.EVENT_TOUCHMOVE, (e) => {
                const touch = e.touches[0];
                mainObject.rotate(touch.dy * 0.4, touch.dx * 0.4, 0);
            });
        });

        // ميكانيكا الأزرار للجوال
        document.getElementById('btn-spin').addEventListener('touchstart', (e) => {
            e.preventDefault();
            if(mainObject) {
                const rotateInterval = setInterval(() => {
                    mainObject.rotate(0, 5, 0);
                }, 16);
                setTimeout(() => clearInterval(rotateInterval), 1000);
            }
        });

        document.getElementById('btn-zoom').addEventListener('touchstart', (e) => {
            e.preventDefault();
            const currentZ = camera.getPosition().z;
            camera.setPosition(0, 0, currentZ === 5 ? 3 : 5);
        });

        window.addEventListener('resize', () => app.resizeCanvas());
    </script>
</body>
</html>
